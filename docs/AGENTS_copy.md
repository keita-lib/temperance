# Temperance の開発ルール（中学生でも分かる版）

このプロジェクトを進めるときの決まりを、やさしい言葉でまとめました。迷ったらここに戻って来てください。

## 1. フォルダの使い方
- `src/` の中にアプリのコードを入れます。
  - 機能ごとに `src/modules/◯◯` というフォルダを作ってまとめます。
  - 共通のボタンやカードなどは `src/components/ui/` へ。
  - データベースや設定などは `src/lib/` へ。
  - React の Hook は `src/hooks/` に入れます。
- テスト関連は `tests/` に入れて、本体とは分けます。
- 画像やアイコンは `public/` に置きます。
- 仕様や開発メモは `docs/` に保存します。
- 自動化スクリプトは `scripts/` にまとめます。

## 2. よく使うコマンド
- 最初にいちど `npm install` で必要なパッケージを入れます。
- 開発サーバーを起動するときは `npm run dev`。
- 本番ビルドは `npm run build`、動作確認は `npm run preview` か `npm run start`。
- コードのチェックは `npm run lint`、テストは `npm run test`。
- テスト範囲を確認したいときは `npm run test -- --coverage`。

## 3. コーディングのルール
- TypeScript を使います。
- インデントは 2 スペース、行末にはセミコロン `;`。
- 文字列は基本的に `'`（シングルクォート）で囲みます。
- React コンポーネント名は `PascalCase`、普通の関数は `camelCase` で書きます。
- 1 ファイルには 1 コンポーネントを目安にして、やりすぎないようにします。
- コミット前に `npm run lint -- --fix` でフォーマットを整えます。

## 4. テストの考え方
- Vitest + Testing Library を使います。
- DOM を探すときは `screen.getByRole` などアクセシビリティを意識した関数を使います。
- モック（仮のデータ）は `tests/mocks` に置いて、`beforeEach` でリセットします。
- ビジネスロジックはハッピーパス（普通のパターン）だけでなく、エッジケース（例外的なパターン）もテストします。
- カバレッジ（テストでカバーされた割合）は 90%以上を目指します。

## 5. Git とプルリクエスト
- コミットメッセージは「Conventional Commits」を使う（例: `feat: add landing SE`）。
- コミット本文にテスト結果を書いておくと親切です。
- プルリクエスト（PR）には次の内容を入れます。
  1. 何を変えたかの短い説明
  2. テストや確認方法
  3. UI を変えたならスクリーンショット
  4. レビューしてほしい人の指定
- 1つの PR は 400 行くらいまでに抑えて、大きな変更は分割します。
- 作業中はドラフト PR を使い、Lint/Test が通ってからレビューを依頼します。

## 6. セキュリティと設定
- 秘密情報（API キーなど）は `.env.local` に書き、Git には含めません。
- 何の環境変数が必要かは `.env.example` にメモしておきます。
- 外部サービスからもらうデータは `src/lib/api` などでチェックしてから使います。
- ライブラリのバージョンは固定し、月に1回くらい `npm audit fix` で脆弱性をチェックします。
- セキュリティを強化したら `docs/security.md` に記録します。

## 7. Temperance 特有のルール
- SPEC.md が唯一の正しい情報です。そこに書いていない機能は追加しません。
- 認証・クラウド同期・LLM など、MVP にない機能は実装しません。
- 規模を大きくしすぎず、まず MVP を完成させることを優先します。
- IndexedDB が真実のデータ源です。UI も IndexedDB の内容だけを表示します。
- UI の言葉は SPEC に載っている用語（節制利益など）を使い、「節約」「管理」など禁止された語は使いません。
- メンターTipsは説教っぽくせず、1〜2文で、選択肢を示すイメージで書きます。
- 実装はシンプルで確実な方法を選び、迷ったら SPEC に沿った一番簡単な方法を選びます。

## 8. 迷ったら
1. SPEC.mdを読み直す。
2. この `AGENTS.md` を見直してルールを確認する。
3. それでも分からなければ、チームメンバーや先輩に相談する。

以上を守れば、Temperance の開発はスムーズに進みます。楽しみながらがんばってください！
